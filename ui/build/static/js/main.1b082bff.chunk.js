(this.webpackJsonpui=this.webpackJsonpui||[]).push([[1],{1058:function(e,t,n){},1070:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),l=n(72),o=n.n(l),i=n(201),u=n(233),s=n(77),m=n(125),d=n.n(m),E=n(90),p=n(162),h={API:"https://bidata.quester-app.dev/core",AUTH:"https://bidata.quester-app.dev/auth"},f={method:"GET",endpoint:"/connections"},b={method:"GET",endpoint:"/connections/drivers"},g=function(e){return{method:"POST",endpoint:"/connections",body:{name:e.name,driver:e.driver,params:{dsn:e.dsn}}}},v=function(e){var t=e.name,n=e.driver,a=e.dsn,r=e.id;return{method:"PUT",endpoint:"/connections/".concat(r),body:{name:t,driver:n,params:{dsn:a}}}},y=function(e){return{method:"POST",endpoint:"/questions",body:e}},O=function(e){return{method:"POST",endpoint:"/executions",body:e}},j={method:"GET",endpoint:"/questions"},x=function(e){return{method:"GET",endpoint:"/questions/".concat(e,"/executions/last")}},w=function(e){return{method:"POST",endpoint:"/dashboards",body:e}},C={method:"GET",endpoint:"/dashboards"},k=function(e){return{method:"POST",endpoint:"/tokens/google",service:"AUTH",body:e}},S=n(156),_=n(147),q=function(e){var t=Object(s.useQuery)(f),n=t.payload,a=Object(_.a)(t,["payload"]);if(!n)return Object(E.a)({},a,{connections:a.loading||a.error?void 0:[]});switch(e){case"map":return Object(E.a)({},a,{connections:n.reduce((function(e,t){return Object(E.a)({},e,Object(S.a)({},t._id,t))}),{})});case"driver":var r=n.map((function(e){return e.driver})).filter((function(e,t,n){return n.indexOf(e)===t})).sort(),c=r.reduce((function(e,t){return Object(E.a)({},e,Object(S.a)({},t,n.filter((function(e){return e.driver===t}))))}),{});return Object(E.a)({},a,{connections:c,drivers:r});default:return Object(E.a)({},a,{connections:n})}},A=n(45),I=n(218),T=function(){},R={mongodb:27017,postgresql:5432},P=function(e){return e.hosts.map((function(t){return"".concat(t.host,":").concat(t.port||R[e.scheme])})).join(", ")},N=function(){var e,t=Object(s.useQuery)(j),n=t.loading,a=t.error,r=t.payload,c=t.query,l=q("map"),o=l.loading,i=l.error,u=l.connections,m=n||o,d=a||i;return r&&u&&(e=r.map((function(e){return Object(E.a)({},e,{connection:u[e.connection_id]})}))),{loading:m,error:d,questions:e,fetchQuestions:c}},D=function(e,t){return r.useMemo((function(){var n=Object(E.a)({},e);if(!t)return n;if(function(e){if(e.length>1||0===e.length)return!1;var t=e[0];return!(!Array.isArray(t)||1!==t.length)||("object"!==typeof t||1===Object.keys(t).length)}(t.data))n.type="scalar",Array.isArray(t.data[0])?n.key=0:"object"!==typeof t.data[0]?n.key=null:n.key=Object.keys(t.data[0])[0];else{n.columns=t.columns;var a,r=Object.keys(n).filter((function(e){return e.startsWith("chart")})),c=Object(I.a)(r);try{for(c.s();!(a=c.n()).done;)for(var l=a.value,o=0,i=["xAxis","yAxis","zAxis"];o<i.length;o++){var u=i[o];n[l][u]&&(Array.isArray(n[l][u])?n[l][u]=n[l][u].filter((function(e){return-1!==n.columns.indexOf(e)})):-1===n.columns.indexOf(n[l][u])&&(n[l][u]=""))}}catch(s){c.e(s)}finally{c.f()}}return n}),[e,t])},z=function(e){var t=Object(s.useQuery)(function(e){return{method:"GET",endpoint:"/questions/".concat(e)}}(e)),n=t.loading,a=t.error,c=t.payload,l=Object(s.useMutation)(function(e){return function(t){return{method:"PUT",endpoint:"/questions/".concat(e),body:t}}}(e)),o=l.loading,i=l.error,u=l.payload,m=l.mutate,h=Object(s.useMutation)(O),f=h.loading,b=h.error,g=h.payload,v=h.mutate,y=Object(s.useClient)().query,j=r.useState(),w=Object(A.a)(j,2),C=w[0],k=w[1],S=r.useState(),_=Object(A.a)(S,2),q=_[0],I=_[1],T=r.useState(),R=Object(A.a)(T,2),P=R[0],N=R[1],D=r.useState(),z=Object(A.a)(D,2),U=z[0],L=z[1];r.useEffect((function(){if(a&&c)return k(!1),void I(c);var e;!q&&c&&(k(!0),y((e=c.connection_id,{method:"GET",endpoint:"/connections/".concat(e)})).then((function(e){var t=e.payload;return new Promise((function(e){y(x(c._id)).then((function(n){var a=n.payload;return e({connectionResponse:t,executionResponse:a})})).catch((function(){return e({connectionResponse:t})}))}))})).then((function(e){var t=e.connectionResponse,n=e.executionResponse;N(t),L(n),k(!1)})).catch((function(e){I(e)})))}),[c,a,y]),r.useEffect((function(){k(n)}),[n]);var Q=function(e){return m({name:c.name,connection_id:c.connection_id,query:e})},F=function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(t);case 2:return e.next=4,v({question_id:c._id,connection_id:P?P._id:void 0,query:t});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{loading:C,error:q,question:!q&&c&&P?Object(E.a)({},u||c,{connection:P}):void 0,execution:g||U,waiting:o||f,errorWaiting:i||b,save:Q,run:F,updateSettings:function(e){return m({visualSettings:e})}}},U=100,L=function(e){return e},Q={loading:!1,error:!1},F=function(e,t){switch(t.type){case"START_QUERY":return Object(E.a)({},e,{result:void 0,loading:!0,error:!1});case"FINISH_QUERY_SUCCESSFULLY":return Object(E.a)({},e,{loading:!1,error:!1,result:t.payload});case"FINISH_QUERY_WITH_ERROR":return Object(E.a)({},e,{loading:!1,error:t.payload||!0,result:void 0});case"REPLACE_EXECUTION":return Object(E.a)({},e,{error:!1,execution:t.payload});default:return e}},M=r.createContext({login:T,logout:T}),W=function(){return r.useContext(M)},G=n(425),H=n(1224),Y=n(236),V=n(1188),B=n(1189),K=n(1190),X=function(){return r.createElement(G.a,null,r.createElement(H.a,{m:1},r.createElement(Y.a,{variant:"h3"},"Welcome to BIData"),r.createElement(V.a,null),r.createElement(H.a,{m:2}),r.createElement(Y.a,{variant:"body2"},r.createElement("strong",null,"Note!")," It's still an early alpha stage. Please report all found bugs"," ",r.createElement(B.a,{target:"_blank",href:"https://github.com/MGrin/bidata/issues"},"here")," ","\ud83d\ude4f"),r.createElement(H.a,{m:2}),r.createElement(Y.a,{variant:"h6"},"Connections"),r.createElement(Y.a,{variant:"body2"},"To start you can ",r.createElement(B.a,{href:"/admin/connections"},"create a connection")," to your database. If you don't want to use your own DB, you can explore publicly available ones"),r.createElement(V.a,null),r.createElement(H.a,{m:2}),r.createElement(Y.a,{variant:"h6"},"Questions"),r.createElement(Y.a,{variant:"body2"},"After configuring your own connections (or not, if you are ok using publicly available ones), you can create a new quesdtion to the data.",r.createElement("br",null),"To do so, click in the button on the right upper corner and select Question."),r.createElement(V.a,null),r.createElement(H.a,{m:2}),r.createElement(Y.a,{variant:"h6"},"Dashboards"),r.createElement(Y.a,{variant:"body2"},"Your questions can be assambled in dashboards. ",r.createElement("br",null),"To create a dashboard, click on the same button in the up right corner and click on Dashboard"),r.createElement(V.a,null),r.createElement(H.a,{m:2,p:2})))},J=function(){var e=N(),t=e.loading,n=e.error,a=e.questions;return r.createElement(K.a,null,t&&r.createElement("h1",null,"Loading"),n&&r.createElement("h1",null,"Error"),a&&r.createElement(H.a,{m:1},r.createElement(X,null)))},Z=function(){return r.createElement("h1",null,"Admin")},$=n(1207),ee=n(1208),te=n(1209),ne=n(1204),ae=n(1205),re=n(1210),ce=n(1093),le=n(344),oe=n.n(le),ie=n(1191),ue=n(1193),se=n(1194),me=n(1195),de=n(1196),Ee=n(1232),pe=n(1227),he=n(1201),fe=n(1234),be=n(1202),ge=n(1203),ve=r.memo((function(e){var t,n=e.connection,a=e.open,c=e.onClose,l=e.setSubmitting,o=e.onSuccess,i=Object(s.useQuery)(b),u=i.loading,m=i.error,E=i.payload,h=Object(s.useMutation)(g),f=h.loading,y=h.mutate,O=Object(s.useMutation)(v),j=O.loading,x=O.mutate;t=u||f||j;var w=r.useState(""),C=Object(A.a)(w,2),k=C[0],S=C[1],_=r.useState(""),q=Object(A.a)(_,2),I=q[0],T=q[1],R=r.useState(""),N=Object(A.a)(R,2),D=N[0],z=N[1],U=r.useState(),L=Object(A.a)(U,2),Q=L[0],F=L[1];r.useEffect((function(){n&&(S(n.name),T(n.driver),z(function(e){var t="".concat(e.scheme,"://");return e.username&&(t+=e.username),e.password&&(t+=":********"),e.username&&(t+="@"),t+=P(e),t+="/".concat(e.endpoint)}(n.metadata)))}),[n]);var M=function(e,t,n){return!!e&&(!!t&&!!n)}(k,I,D),W=function(){T(""),S(""),z("")},G=function(){var e=Object(p.a)(d.a.mark((function e(){var t,a,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(void 0),l(!0),t=n?x:y,e.next=5,t({name:k,driver:I,dsn:D,id:n?n._id:void 0});case 5:if(a=e.sent,r=a.payload,c=a.error,l(!1),!c){e.next=11;break}return e.abrupt("return",F(r));case 11:W(),o();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.createElement(ie.a,{open:a,onClose:c},r.createElement(ue.a,null,"Add new connection"),r.createElement(se.a,null,r.createElement(me.a,null,"To create new connection, please select the database type and provide the connection string:"),r.createElement(de.a,{fullWidth:!0,disabled:t},r.createElement(Ee.a,{id:"database-type-select-label"},"Database type"),r.createElement(pe.a,{labelId:"database-type-select-label",id:"database-type-select",value:I,required:!0,disabled:t||m,error:m,onChange:function(e){var t=e.target.value;T(t),z("".concat(t,"://"))}},E&&E.map((function(e){return r.createElement(he.a,{key:e,value:e},e)}))),r.createElement(fe.a,{required:!0,label:"Name",type:"text",value:k,disabled:t,onChange:function(e){var t=e.target.value;return S(t)}}),r.createElement(fe.a,{required:!0,label:"Connection string",helperText:"DSN format: scheme://[user:[password@]]host1[:port1][,host2:[port2],...[,hostN:[portN]]][[/]?options]",type:"url",value:D,disabled:t,onChange:function(e){var t=e.target.value;return z(t)}}),Q&&r.createElement(Y.a,{color:"error",variant:"caption"},"Error: ",Q.message),t&&r.createElement(be.a,null))),r.createElement(ge.a,null,r.createElement(ce.a,{disabled:t,onClick:function(e){W(),c&&c()},color:"secondary"},"Cancel"),r.createElement(ce.a,{disabled:!M||t,onClick:G,color:"primary"},n?"Update":"Add")))})),ye=n(1206),Oe=n(521),je=n.n(Oe),xe=n(343),we=n.n(xe),Ce=n(520),ke=n.n(Ce),Se=function(e){switch(e.driver){case"mongodb":return r.createElement("img",{alt:"mongodb",src:"https://store-images.s-microsoft.com/image/apps.6989.5a75739e-6663-45e9-b4c8-974dcbde28a9.96b28dd0-717a-4e5b-85f1-2727929049c5.55e5d6e3-bd01-4752-b1a5-b6c5450faa32",width:"40px",height:"40px"});case"postgresql":return r.createElement("img",{alt:"postgresql",src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Postgresql_elephant.svg/1080px-Postgresql_elephant.svg.png",width:"30px",height:"30px"});default:return null}},_e=r.memo((function(e){var t=e.connection,n=e.onEdit,a=Object(s.useQuery)(function(e){var t=e._id;return{method:"GET",endpoint:"/connections/".concat(t,"/connectivity")}}(t)),c=a.loading,l=a.error,o=a.query,i=!c&&!l,u=W().user;return r.useEffect((function(){o()}),[t,o]),r.createElement(ne.a,{hover:!0},r.createElement(ae.a,{align:"center"},r.createElement(Se,{driver:t.driver})),r.createElement(ae.a,{align:"center"},c&&r.createElement(ye.a,{size:16}),l&&r.createElement(we.a,{color:"error"}),i&&r.createElement(ke.a,{color:"primary"})),r.createElement(ae.a,null,r.createElement(Y.a,{variant:"overline"},t.name)),r.createElement(ae.a,null,t.metadata.username||""),r.createElement(ae.a,null,P(t.metadata)),r.createElement(ae.a,null,t.metadata.endpoint),r.createElement(ae.a,null,u&&u._id===t.owner_id&&r.createElement(ce.a,{size:"small",variant:"outlined",color:"primary",startIcon:r.createElement(je.a,null),onClick:n},"Edit")))})),qe=function(){var e=q(),t=e.loading,n=e.error,a=e.connections,c=e.query,l=r.useState(),o=Object(A.a)(l,2),i=o[0],u=o[1],s=r.useState(!1),m=Object(A.a)(s,2),d=m[0],E=m[1],p=r.useState(!1),h=Object(A.a)(p,2),f=h[0],b=h[1],g=function(){d||(u(void 0),b(!1))};return r.createElement(K.a,null,t&&r.createElement("h1",null,"Loading"),n&&r.createElement("h1",null,"Error"),a&&r.createElement(H.a,{m:1},a.length>0&&r.createElement(Y.a,{variant:"h6"},"Connections:"),r.createElement(H.a,{mb:1},r.createElement($.a,null,r.createElement(ee.a,null,r.createElement(te.a,null,r.createElement(ne.a,null,r.createElement(ae.a,{align:"center"},"Driver"),r.createElement(ae.a,null),r.createElement(ae.a,null,"Name"),r.createElement(ae.a,null,"Username"),r.createElement(ae.a,null,"Hosts"),r.createElement(ae.a,null,"Database"),r.createElement(ae.a,null))),r.createElement(re.a,null,a.map((function(e){return r.createElement(_e,{key:e._id,connection:e,onEdit:function(){return function(e){u(e),b(!0)}(e)}})})))))),r.createElement(ce.a,{variant:"outlined",color:"primary",startIcon:r.createElement(oe.a,null),onClick:function(){return b(!0)}},"Add connection")),r.createElement(ve,{open:f,connection:i,onClose:g,onSuccess:function(){c(),g()},setSubmitting:E}))},Ae=n(1230),Ie=n(1236),Te=n(1200),Re=n(1092),Pe=n(1212),Ne=n(1213),De=n(1215),ze=n(1216),Ue=n(1217),Le=n(1237),Qe=n(1199),Fe=n(1218),Me=n(559),We=n(1214),Ge=n(1231),He=n(121),Ye=n(1211),Ve=n(525),Be=n.n(Ve),Ke=n(303),Xe=n.n(Ke),Je=n(302),Ze=n.n(Je),$e=n(523),et=n.n($e),tt=n(524),nt=n.n(tt),at=n(526),rt=n.n(at),ct=function(e){var t=e.open,n=e.onClose,a=e.onSuccess,c=q(),l=c.loading,o=c.error,i=c.connections,u=c.query,m=Object(s.useMutation)(y),E=m.loading,h=m.mutate,f=l||E,b=r.useState(""),g=Object(A.a)(b,2),v=g[0],O=g[1],j=r.useState(""),x=Object(A.a)(j,2),w=x[0],C=x[1],k=r.useState(""),S=Object(A.a)(k,2),_=S[0],I=S[1],T=r.useState(),R=Object(A.a)(T,2),P=R[0],N=R[1];r.useEffect((function(){t&&u()}),[t,u]);var D=function(e,t){return!!e&&!!t}(v,_),z=function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(void 0),t={name:_,connection_id:v,visualSettings:{type:"mongodb"===w?"documents":"columns"}},e.next=4,h(t);case 4:if(n=e.sent,r=n.payload,!n.error){e.next=9;break}return e.abrupt("return",N(r));case 9:O(""),I(""),a(r);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.createElement(ie.a,{open:t,onClose:n},r.createElement(ue.a,null,r.createElement(H.a,{display:"flex",flexDirection:"row",alignItems:"center"},r.createElement(Ze.a,null),r.createElement(H.a,{m:1}),"Add new question")),r.createElement(se.a,null,r.createElement(me.a,null,"To create new questions, please select the connection:"),r.createElement(de.a,{fullWidth:!0,disabled:f},r.createElement(Ee.a,{id:"connection-select-label"},"Connection"),r.createElement(pe.a,{labelId:"connection-select-label",id:"connection-select",value:v,required:!0,disabled:f,error:o,onChange:function(e){var t=e.target.value;O(t),C(i.find((function(e){return e._id===t})).driver)}},i&&i.map((function(e){return r.createElement(he.a,{key:e._id,value:e._id},e.name)})))),r.createElement(de.a,{fullWidth:!0,disabled:f},r.createElement(fe.a,{required:!0,label:"Name",type:"text",value:_,disabled:f,onChange:function(e){var t=e.target.value;return I(t)}})),P&&r.createElement(Y.a,{color:"error",variant:"caption"},"Error: ",P&&P.message),f&&r.createElement(be.a,null)),r.createElement(ge.a,null,r.createElement(ce.a,{disabled:f,onClick:function(e){n&&n()},color:"secondary"},"Cancel"),r.createElement(ce.a,{disabled:!D||f,onClick:z,color:"primary"},"Create question")))},lt=n(1197),ot=n(1235),it=function(e){var t=e.open,n=e.onClose,a=e.onSuccess,c=N(),l=c.loading,o=c.questions,i=c.fetchQuestions,u=Object(s.useMutation)(w),m=u.loading,E=u.mutate,h=l||m,f=r.useState(""),b=Object(A.a)(f,2),g=b[0],v=b[1],y=r.useState(""),O=Object(A.a)(y,2),j=O[0],x=O[1],C=r.useState(),k=Object(A.a)(C,2),S=k[0],_=k[1],q=r.useState([]),I=Object(A.a)(q,2),T=I[0],R=I[1],P=r.useState(),D=Object(A.a)(P,2),z=D[0],U=D[1];r.useEffect((function(){t&&i()}),[t,i]);var L=function(e){return!!e}(g),Q=function(){v(""),_(void 0),R([]),U(void 0)},F=function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U(void 0),t={name:g,description:j,updateFrequency:S,questions:T},e.next=4,E(t);case 4:if(n=e.sent,r=n.payload,!n.error){e.next=9;break}return e.abrupt("return",U(r));case 9:Q(),a(r);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.createElement(ie.a,{open:t,onClose:function(e,t){Q(),n&&n()}},r.createElement(ue.a,null,r.createElement(H.a,{display:"flex",flexDirection:"row",alignItems:"center"},r.createElement(Xe.a,null),r.createElement(H.a,{m:1}),"Add new dashboard")),r.createElement(se.a,null,r.createElement(me.a,null,"To create new dashboard, please provide a name and a list of questions. Don't worry, you'll be able to change this list later"),r.createElement(de.a,{fullWidth:!0,disabled:h},r.createElement(fe.a,{required:!0,label:"Name",type:"text",value:g,disabled:h,onChange:function(e){var t=e.target.value;return v(t)}})),r.createElement(de.a,{fullWidth:!0,disabled:h},r.createElement(fe.a,{required:!0,label:"Description",type:"text",multiline:!0,value:j,disabled:h,onChange:function(e){var t=e.target.value;return x(t)}})),r.createElement(de.a,{fullWidth:!0,disabled:h},r.createElement(Ee.a,{id:"questions-selector-label"},"Questions"),r.createElement(pe.a,{labelId:"questions-selector-label",id:"questions-selector",multiple:!0,value:T,onChange:function(e){var t=e.target.value;return R(t)},input:r.createElement(lt.a,{id:"questions-selector-input"}),renderValue:function(e){return e.map((function(e){return r.createElement(ot.a,{key:e,label:o.find((function(t){return t._id===e})).name})}))}},o&&o.map((function(e){return r.createElement(he.a,{key:e._id,value:e._id},e.name)})))),z&&r.createElement(Y.a,{color:"error",variant:"caption"},"Error: ",z&&z.message),h&&r.createElement(be.a,null)),r.createElement(ge.a,null,r.createElement(ce.a,{disabled:h,onClick:function(e){Q(),n&&n()},color:"secondary"},"Cancel"),r.createElement(ce.a,{disabled:!L||h,onClick:F,color:"primary"},"Create dashboard")))},ut=function(){return r.createElement("img",{width:"20px",height:"20px",alt:"Google logo",src:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/1024px-Google_%22G%22_Logo.svg.png"})},st=function(){var e=Object(u.h)(),t=e.pathname.split("/").filter((function(e,t,n){return n.indexOf(e)===t})),n="/",a=Object(He.a)();return Object(Ye.a)(a.breakpoints.down("xs"))&&(t=[t[t.length-1]]),r.createElement(Ae.a,{color:"primary.contrastText"},t.map((function(a,c){n+=a?"".concat(a,"/"):"";var l=a||"BIData";return c===t.length-1&&(l=e.state&&e.state.title?e.state.title:l),r.createElement(B.a,{key:n,color:"inherit",href:n,variant:"h6"},l)})))},mt=function(e){var t=e.open,n=e.navigate,a=e.onClose,c=Object(u.h)(),l=Object(u.g)();return r.createElement(Ie.a,{anchor:"left",open:t,onClose:a},r.createElement(H.a,{width:300},r.createElement(Te.a,{dense:!0},r.createElement(Re.a,{onClick:function(){l.push("/"),a()}},r.createElement(Y.a,{variant:"h3"},"BIData")),r.createElement(Re.a,{button:!0,selected:"/dashboards"===c.pathname,onClick:function(){return n("/dashboards")}},r.createElement(Pe.a,null,r.createElement(Xe.a,null)),r.createElement(Ne.a,{primary:"Dashboards"})),r.createElement(Re.a,{button:!0,selected:"/questions"===c.pathname,onClick:function(){return n("/questions")}},r.createElement(Pe.a,null,r.createElement(Ze.a,null)),r.createElement(Ne.a,{primary:"Questions"})),r.createElement(V.a,null),r.createElement(Re.a,{button:!0,selected:"/admin/connections"===c.pathname,onClick:function(){return n("/admin/connections")}},r.createElement(Pe.a,null,r.createElement(et.a,null)),r.createElement(Ne.a,{primary:"Connections"})))))},dt=Object(We.a)((function(e){return Object(Ge.a)({small:{width:e.spacing(4),height:e.spacing(4)}})})),Et=Object(We.a)((function(e){return Object(Ge.a)({popover:{marginTop:e.spacing(2)}})})),pt=function(e){var t=e.openMenu,n=e.openAddNewSelector,a=e.openUserMenu,c=Object(He.a)(),l=Object(Ye.a)(c.breakpoints.down("xs")),o=W().user,i=dt().small;return r.createElement(De.a,{style:{paddingLeft:0}},r.createElement(ze.a,{container:!0,direction:"row",justify:"space-between","align-items":"center"},r.createElement(H.a,{color:"primary.contrastText",display:"flex",flexDirection:"row",alignItems:"center"},r.createElement(Ue.a,{style:{color:"white"},onClick:t},r.createElement(nt.a,null)),r.createElement(st,null)),r.createElement(H.a,{display:"flex",flexDirection:"row",alignItems:"center"},l?r.createElement(Ue.a,{color:"inherit",onClick:n},r.createElement(Be.a,null)):r.createElement(ce.a,{variant:"outlined",color:"inherit",size:"small",startIcon:r.createElement(oe.a,null),onClick:n},"Add new ..."),r.createElement(H.a,{m:1}),r.createElement(Ue.a,{onClick:a},r.createElement(Le.a,{alt:"".concat(null===o||void 0===o?void 0:o.firstName," ").concat(null===o||void 0===o?void 0:o.lastName),src:null===o||void 0===o?void 0:o.picture,className:i})))))},ht=function(e){var t=e.open,n=e.anchorEl,a=e.openNewDashboard,c=e.openNewQuestion,l=e.onClose,o=Et();return r.createElement(Qe.a,{open:t,keepMounted:!0,anchorEl:n,onClose:l,className:o.popover,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.createElement(he.a,{onClick:a},r.createElement(Pe.a,null,r.createElement(Xe.a,null)),r.createElement(Ne.a,{primary:"Dashboard"})),r.createElement(he.a,{onClick:c},r.createElement(Pe.a,null,r.createElement(Ze.a,null)),r.createElement(Ne.a,{primary:"Question"})))},ft=function(e){var t=e.open,n=e.anchorEl,a=e.logout,c=e.onClose;return r.createElement(Qe.a,{open:t,keepMounted:!0,anchorEl:n,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.createElement(he.a,{onClick:a},r.createElement(Pe.a,null,r.createElement(rt.a,null)),r.createElement(Ne.a,{primary:"Log out"})))},bt=r.memo((function(){var e=Object(u.g)(),t=r.useState(null),n=Object(A.a)(t,2),a=n[0],c=n[1],l=r.useState(null),o=Object(A.a)(l,2),i=o[0],s=o[1],m=r.useState(!1),d=Object(A.a)(m,2),E=d[0],p=d[1],h=r.useState(!1),f=Object(A.a)(h,2),b=f[0],g=f[1],v=r.useState(!1),y=Object(A.a)(v,2),O=y[0],j=y[1],x=W().logout;return r.createElement(Fe.a,{position:"static"},r.createElement(pt,{openMenu:function(){return p(!0)},openAddNewSelector:function(e){return c(e.currentTarget)},openUserMenu:function(e){return s(e.currentTarget)}}),r.createElement(mt,{open:E,onClose:function(){return p(!1)},navigate:function(t){e.push(t),p(!1)}}),r.createElement(ht,{open:!!a,anchorEl:a,openNewDashboard:function(){c(null),j(!0)},openNewQuestion:function(){c(null),g(!0)},onClose:function(){return c(null)}}),r.createElement(ft,{open:!!i,anchorEl:i,logout:x,onClose:function(){return s(null)}}),r.createElement(ct,{open:b,onClose:function(){return g(!1)},onSuccess:function(t){e.push("/questions/".concat(t._id)),g(!1)}}),r.createElement(it,{open:O,onClose:function(){return j(!1)},onSuccess:function(t){e.push("/dashboards/".concat(t._id)),j(!1)}}))})),gt=r.memo((function(){var e=r.useState(),t=Object(A.a)(e,2),n=t[0],a=t[1],c=W().login;return r.createElement(Fe.a,{position:"static"},r.createElement(De.a,null,r.createElement(ze.a,{container:!0,direction:"row",justify:"space-between","align-items":"center"},r.createElement(Y.a,{variant:"h6"},"BIData"),r.createElement(H.a,{display:"flex",flexDirection:"row",alignItems:"center"},r.createElement(ce.a,{variant:"outlined",color:"inherit",size:"small",disabled:!c,onClick:function(e){return a(e.currentTarget)}},"Sign In")))),r.createElement(Me.a,{open:!!n,keepMounted:!0,anchorEl:n,onClose:function(){return a(null)}},r.createElement(he.a,{onClick:function(){return c&&c("google")},dense:!0},r.createElement(Pe.a,null,r.createElement(ut,null)),r.createElement(Ne.a,{primary:"Signin with Google"}))))})),vt=r.memo((function(){return W().user?r.createElement(bt,null):r.createElement(gt,null)})),yt=n(1238),Ot=n(527),jt=n.n(Ot),xt=n(528),wt=n.n(xt),Ct=n(1226),kt=r.memo((function(e){var t=e.question,n=Object(s.useQuery)(x(t._id)),a=n.loading,c=n.error,l=n.payload;return a?r.createElement(ye.a,{size:14}):c?(console.log(l),null):l?r.createElement(yt.a,{title:r.createElement(Ct.a,{date:new Date(l.created),locale:"en"}),placement:"right",arrow:!0},function(e){switch(e.state){case"DONE":return r.createElement(jt.a,{color:"primary"});case"ERROR":return r.createElement(we.a,{color:"error"});default:return r.createElement(wt.a,null)}}(l)):null})),St=n(1229),_t=n(1239),qt=n(1220),At=n(532),It=n.n(At),Tt=n(531),Rt=n.n(Tt),Pt=n(533),Nt=n.n(Pt),Dt=n(534),zt=n.n(Dt),Ut=n(535),Lt=n.n(Ut),Qt=n(536),Ft=n.n(Qt),Mt=n(537),Wt=n.n(Mt),Gt=n(1219),Ht=function(e){var t=e.children,n=e.settings,a=e.execution,c=e.driver,l=e.editable,o=e.requestVisualTypeChange,i=e.openVisualSettingsForm,u=Object(_.a)(e,["children","settings","execution","driver","editable","requestVisualTypeChange","openVisualSettingsForm"]),s=Object(He.a)(),m=Object(Ye.a)(s.breakpoints.down("sm"));return r.createElement(H.a,Object.assign({},u,{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}),r.createElement(H.a,{p:2},!m&&a&&r.createElement(Y.a,{variant:"caption"},"Ran ",r.createElement(Ct.a,{date:Object(Gt.a)(a.created)})),m&&a&&r.createElement(yt.a,{disableFocusListener:!0,title:r.createElement(Ct.a,{date:Object(Gt.a)(a.created),locale:"en"}),placement:"top",arrow:!0},r.createElement(Rt.a,{fontSize:"small"}))),!m&&l&&"scalar"!==n.type&&r.createElement(H.a,{display:"flex",flexDirection:"row",alignItems:"center"},r.createElement(_t.a,{size:"small",value:n.type,exclusive:!0,onChange:function(e,t){t&&o(t,n)}},r.createElement(qt.a,{size:m?"small":void 0,value:"mongodb"===c?"documents":"columns"},r.createElement(yt.a,{title:"Table",placement:"top",arrow:!0,disableFocusListener:!0},r.createElement(It.a,{color:"documents"===n.type||"columns"===n.type?"primary":void 0}))),r.createElement(qt.a,{value:"chart.line",size:m?"small":void 0},r.createElement(yt.a,{title:"Line chart",placement:"top",arrow:!0,disableFocusListener:!0},r.createElement(Nt.a,{color:"chart.line"===n.type?"primary":void 0}))),r.createElement(qt.a,{value:"chart.pie",size:m?"small":void 0},r.createElement(yt.a,{title:"Pie chart",placement:"top",arrow:!0,disableFocusListener:!0},r.createElement(zt.a,{color:"chart.pie"===n.type?"primary":void 0}))),r.createElement(qt.a,{value:"chart.bar",size:m?"small":void 0},r.createElement(yt.a,{title:"Bar chart",placement:"top",arrow:!0,disableFocusListener:!0},r.createElement(Lt.a,{color:"chart.bar"===n.type?"primary":void 0}))),r.createElement(qt.a,{value:"chart.bubble",size:m?"small":void 0},r.createElement(yt.a,{title:"Bubble chart",placement:"top",arrow:!0,disableFocusListener:!0},r.createElement(Ft.a,{color:"chart.bubble"===n.type?"primary":void 0})))),r.createElement(H.a,{ml:1},"documents"!==n.type&&"columns"!==n.type&&r.createElement(Ue.a,{onClick:i},r.createElement(Wt.a,{color:"primary",className:"clickable"})))),"documents"===n.type||"columns"===n.type?t:r.createElement(H.a,null))},Yt=n(539),Vt=n(1223),Bt=n(538),Kt=n.n(Bt),Xt=function(e){var t=e.children,n=e.collapsed,a=e.named,c=Object(_.a)(e,["children","collapsed","named"]),l=t;if(void 0===l||null===l)return r.createElement(Y.a,Object.assign({variant:"overline"},c),"null");if("boolean"===typeof l)return r.createElement(Y.a,Object.assign({variant:"body2"},c),l?"Yes":"No");if("number"===typeof l||"bigint"===typeof l)return r.createElement(Y.a,Object.assign({variant:"body2"},c),l);if("string"===typeof l)try{l=JSON.parse(t)}catch(i){}if("object"===typeof l)return r.createElement(Kt.a,{src:l,name:!!a&&(l.name||l._id),indentWidth:2,collapsed:void 0===n||n,enableClipboard:!1,displayDataTypes:!1});var o=Object(Gt.a)(l);return Object(Yt.a)(o)&&(l=Object(Vt.a)(o,"yyyy-MM-dd HH:mm:ss")),r.createElement(Y.a,Object.assign({variant:"body2",style:{maxHeight:98,overflowY:"auto"}},c),l)},Jt=r.memo((function(e){var t=e.data,n=e.settings,a=e.page,c=e.rowsPerPage;return r.createElement($.a,{className:"scrollable",style:{height:"calc(100% - 50px)"}},r.createElement(ee.a,{stickyHeader:!0},"columns"===n.type&&r.createElement(te.a,null,r.createElement(ne.a,null,n.columns.map((function(e){return r.createElement(ae.a,{key:e},e)})))),r.createElement(re.a,null,t.slice(a*c,a*c+c).map((function(e,t){return r.createElement(ne.a,{key:"row_".concat(t),hover:!0},"columns"===n.type&&n.columns&&r.createElement(r.Fragment,null,n.columns.map((function(n){return r.createElement(ae.a,{key:"row_".concat(t,"_column_").concat(n),style:{minWidth:200}},r.createElement(Xt,null,e[n]))}))),"documents"===n.type&&r.createElement(ae.a,null,r.createElement(Xt,{collapsed:1,named:!0},e)))})))))})),Zt=r.memo((function(e){var t=e.data,n=e.settings;return r.createElement(H.a,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",height:"calc(100% - 50px)"},r.createElement(Xt,{gutterBottom:!0,variant:"h2"},n.key?t[0][n.key]:t[0]))})),$t=n(187),en=n(75),tn=function(e){var t=e.data,n=e.settings,a=n["chart.line"].asArea?en.b:en.h,c=n["chart.line"].asArea?en.a:en.g;return r.createElement(H.a,{pr:3,width:"calc(100% - 16)",height:"calc(100% - 50px)"},r.createElement($t.a,null,(function(e){var l=e.width,o=e.height;return r.createElement(a,{width:l,height:o,data:t},n["chart.line"].asArea&&r.createElement("defs",null,n["chart.line"].yAxis.map((function(e){return r.createElement("linearGradient",{id:"color_".concat(e),x1:"0",y1:"0",x2:"0",y2:"1"},r.createElement("stop",{offset:"5%",stopColor:n["chart.line"].colors[e],stopOpacity:.8}),r.createElement("stop",{offset:"95%",stopColor:n["chart.line"].colors[e],stopOpacity:0}))}))),r.createElement(en.e,{strokeDasharray:"3 3"}),r.createElement(en.o,{dataKey:n["chart.line"].xAxis}),r.createElement(en.p,null),r.createElement(en.n,{cursor:{strokeDasharray:"3 3"}}),r.createElement(en.f,null),n["chart.line"].yAxis.map((function(e){return r.createElement(c,{key:e,type:"monotone",dataKey:e,stroke:n["chart.line"].colors[e],fillOpacity:1,fill:"url(#color_".concat(e,")")})})))})))},nn=function(e){var t=e.data,n=e.settings;return r.createElement(H.a,{pr:3,width:"calc(100% - 16)",height:"calc(100% - 50px)"},r.createElement($t.a,null,(function(e){var a=e.width,c=e.height;return r.createElement(en.d,{width:a,height:c,data:t},r.createElement(en.e,{strokeDasharray:"3 3"}),r.createElement(en.o,{dataKey:n["chart.bar"].xAxis}),r.createElement(en.p,null),r.createElement(en.n,null),r.createElement(en.f,null),n["chart.bar"].yAxis.map((function(e){return r.createElement(en.c,{key:e,dataKey:e,fill:n["chart.bar"].colors[e]})})))})))},an=r.memo((function(e){var t=e.data,n=e.settings,a=n["chart.pie"].xAxis,c=n["chart.pie"].yAxis,l=n["chart.pie"].colors,o=t.map((function(e){var t,n=Object(S.a)({},a,e[a]),r=Object(I.a)(c);try{for(r.s();!(t=r.n()).done;){var l=t.value;n[l]=parseFloat(e[l])}}catch(o){r.e(o)}finally{r.f()}return n}));return r.createElement(H.a,{pr:3,width:"calc(100% - 16)",height:"calc(100% - 50px)"},r.createElement($t.a,null,(function(e){var t=e.width,n=e.height;return r.createElement(en.j,{width:t,height:n},r.createElement(en.k,{strokeDasharray:"5 5"}),r.createElement(en.n,{cursor:{strokeDasharray:"3 3"}}),c.map((function(e,t){return r.createElement(en.i,{key:e,data:o,nameKey:a,dataKey:e,cx:"50%",cy:"50%",innerRadius:20+40*t+10*t,outerRadius:20+40*(t+1)+10*t,fill:l[e]})})))})))})),rn=function(e){var t=e.data,n=e.settings,a=n["chart.bubble"].xAxis,c=n["chart.bubble"].yAxis,l=n["chart.bubble"].zAxis,o=n["chart.bubble"].colors,i=t.map((function(e){var t,n,r=(t={},Object(S.a)(t,a,e[a]),Object(S.a)(t,c,e[c]),t),o=Object(I.a)(l);try{for(o.s();!(n=o.n()).done;){var i=n.value;r[i]=parseFloat(e[i])}}catch(u){o.e(u)}finally{o.f()}return r}));return console.log(i),r.createElement(H.a,{pr:3,width:"calc(100% - 16)",height:"calc(100% - 50px)"},r.createElement($t.a,null,(function(e){var n=e.width,i=e.height;return r.createElement(en.m,{width:n,height:i,data:t},r.createElement(en.e,{strokeDasharray:"3 3"}),r.createElement(en.o,{dataKey:a,name:a}),r.createElement(en.p,{dataKey:c,name:c}),r.createElement(en.q,{dataKey:"__Z VALUE CUSTON NAMED__",name:"value"}),r.createElement(en.n,{cursor:{strokeDasharray:"3 3"}}),r.createElement(en.f,null),l.map((function(e){return r.createElement(en.l,{key:e,name:e,dataKey:e,fill:o[e]})})))})))},cn=r.memo((function(e){var t=e.data,n=e.settings,a=Object(_.a)(e,["data","settings"]);switch(n.type){case"scalar":return r.createElement(Zt,{data:t,settings:n});case"chart.line":return r.createElement(tn,{data:t,settings:n});case"chart.bar":return r.createElement(nn,{data:t,settings:n});case"chart.pie":return r.createElement(an,{data:t,settings:n});case"chart.bubble":return r.createElement(rn,{data:t,settings:n});default:return r.createElement(Jt,Object.assign({data:t,settings:n},a))}})),ln=r.memo((function(e){var t=e.execution,n=e.settings,a=e.driver,c=e.editable,l=e.requestVisualTypeChange,o=e.openVisualSettingsForm,i=e.onResultUpdate,u=Object(He.a)(),m=Object(Ye.a)(u.breakpoints.down("sm")),d=function(e){var t=Object(s.useClient)().query,n=r.useReducer(F,Q,L),a=Object(A.a)(n,2),c=a[0],l=c.execution,o=c.result,i=c.loading,u=c.error,m=a[1];return{loading:i,error:u,execution:l,result:o,setExecution:function n(a){var r;!a||l&&l._id===a._id||m({type:"REPLACE_EXECUTION",payload:a}),"CREATED"===a.state||"RUNNING"===a.state?(m({type:"START_QUERY"}),setTimeout((function(){return function(e,t,n,a){return e(function(e){return{method:"GET",endpoint:"/executions/".concat(e)}}(t)).then((function(e){var t=e.payload;n(t)})).catch((function(){a({type:"FINISH_QUERY_WITH_ERROR",payload:null})}))}(t,a._id,n,m)}),U),U<3e3&&(U+=100)):"DONE"===a.state?(U=100,t((r=a.results,{method:"GET",endpoint:"/results/".concat(r)})).then((function(t){var n=t.payload;m({type:"FINISH_QUERY_SUCCESSFULLY",payload:n}),e(n)})).catch((function(){m({type:"FINISH_QUERY_WITH_ERROR",payload:null})}))):"ERROR"===a.state&&m({type:"FINISH_QUERY_WITH_ERROR",payload:a.error})}}}(i||T),E=d.loading,p=d.error,h=d.result,f=d.execution,b=d.setExecution,g=function(){var e=[10,25,50],t=r.useState(0),n=Object(A.a)(t,2),a=n[0],c=n[1],l=r.useState(10),o=Object(A.a)(l,2),i=o[0],u=o[1];return{page:a,rowsPerPage:i,rowsPerPageOptions:e,handleChangePage:function(e,t){c(t)},handleChangeRowsPerPage:function(t){u(parseInt(t.target.value,e[0])),c(0)}}}(),v=g.page,y=g.rowsPerPage,O=g.rowsPerPageOptions,j=g.handleChangePage,x=g.handleChangeRowsPerPage;r.useEffect((function(){!t||f&&t._id===f._id||b(t)}),[t,b,f]);var w=D(n,h);return r.createElement(r.Fragment,null,E&&r.createElement("span",null,"Loading"),p&&r.createElement("span",null,"Error"),h&&r.createElement(H.a,{p:1,height:"100%"},r.createElement(G.a,{style:{height:"100%"}},r.createElement(cn,{data:h.data,settings:w,page:v,rowsPerPage:y}),r.createElement(St.a,{rowsPerPageOptions:O,component:function(e){var t=e.children,n=Object(_.a)(e,["children"]);return r.createElement(Ht,Object.assign({execution:f,settings:w,driver:a,editable:c||!1,requestVisualTypeChange:l||T,openVisualSettingsForm:o||T},n),t)},count:h.data.length,rowsPerPage:y,page:v,onChangePage:j,onChangeRowsPerPage:x,labelRowsPerPage:m?null:void 0,labelDisplayedRows:m?function(e){return e.page+1}:void 0}))))})),on=n(554),un=n.n(on),sn=n(553),mn=function(e){var t=e.color,n=e.size,a=t?{fill:t,marginLeft:6}:void 0;return r.createElement(un.a,{style:a,fontSize:n})},dn=function(e){var t=e.column,n=e.color,a=e.onChange,c=r.useState(null),l=Object(A.a)(c,2),o=l[0],i=l[1],u=n?{borderColor:n,color:n}:void 0;return r.createElement(ze.a,{item:!0,className:"clickable"},r.createElement(ce.a,{style:u,startIcon:r.createElement(mn,{color:n}),variant:"outlined",color:"default",onClick:function(e){return i(e.currentTarget)}},t),r.createElement(Qe.a,{open:!!o,anchorEl:o,onClose:function(){return i(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},r.createElement(sn.BlockPicker,{color:n,onChangeComplete:function(e){var t=e.hex;a(t),i(null)}})))},En=function(e){var t=e.component,n=e.roles,a=Object(_.a)(e,["component","roles"]),c=W().user,l=t;return r.createElement(u.b,Object.assign({},a,{exact:!0,render:function(e){return function(e,t){if(!e)return!1;if(!t)return!0;if(!e.roles)return!1;for(var n=e.roles.sort(),a=e.roles.sort(),r=0;r<Math.min(e.roles.length,t.length);r++)if(n[r]===a[r])return!0;return!1}(c,n)?r.createElement(l,e):r.createElement(u.a,{to:"/"})}}))};gapi.load("auth2",{callback:function(){try{gapi.auth2.init({client_id:"107346167044-2h7e6g7dsj3rl2tqmi2e8qv5le1tdn0p.apps.googleusercontent.com",ux_mode:"redirect"}).then((function(){a=!0}))}catch(e){a=!1,console.error(e)}},onerror:function(e){a=!1,console.error(e)}});var pn=function(e){var t=e.children,n=r.useState(!1),c=Object(A.a)(n,2),l=c[0],o=c[1],i=r.useState(localStorage.getItem("token")||void 0),u=Object(A.a)(i,2),m=u[0],d=u[1],E=r.useState(),p=Object(A.a)(E,2),h=p[0],f=p[1],b=r.useState(!0),g=Object(A.a)(b,2),v=g[0],y=g[1],O=Object(s.useClient)().query,j=Object(s.useMutation)(k),x=(j.loading,j.error,j.payload,j.mutate);if(r.useEffect(function e(t){return function(){void 0!==a?t(a):setTimeout(e(t),10)}}(o),[]),r.useEffect((function(){if(l&&!m){var e=gapi.auth2.getAuthInstance();if(e.isSignedIn.get()){var t=e.currentUser.get().getBasicProfile(),n={email:t.getEmail(),firstName:t.getName(),lastName:t.getFamilyName(),picture:t.getImageUrl()};x(n).then((function(e){var t=e.error,n=e.payload;t||d(n.token)}))}}}),[l,x,m]),r.useEffect((function(){m?(y(!0),O(function(e){return{method:"GET",endpoint:"/tokens/user?token=".concat(e),service:"AUTH"}}(m)).then((function(e){var t=e.error,n=e.payload;t?(console.error(n),d(void 0),f(void 0),y(!1)):(localStorage.setItem("token",m),f(n),y(!1))}))):(f(void 0),y(!1),localStorage.removeItem("token"))}),[m,O]),v)return r.createElement("h1",null,"Loading user");return r.createElement(M.Provider,{value:{user:h,setToken:d,setUser:f,login:l?function(e){if("google"===e){var t=gapi.auth2.getAuthInstance();t&&t.signIn()}}:T,logout:l?function(){var e=gapi.auth2.getAuthInstance();e&&e.signOut(),d(void 0)}:T}},t)},hn=function(){var e=Object(u.g)(),t=N(),n=t.loading,a=t.error,c=t.questions;return r.createElement(K.a,null,n&&r.createElement("h1",null,"Loading"),a&&r.createElement("h1",null,"Error"),c&&r.createElement(H.a,{m:1},r.createElement($.a,{component:G.a},r.createElement(ee.a,null,r.createElement(te.a,null,r.createElement(ne.a,null,r.createElement(ae.a,null,"Name"),r.createElement(ae.a,null,"Connection"),r.createElement(ae.a,null))),r.createElement(re.a,null,c.map((function(t){return r.createElement(ne.a,{key:t._id,hover:!0,classes:{hover:"clickable"},onClick:function(){return e.push("/questions/".concat(t._id))}},r.createElement(ae.a,null,t.name),r.createElement(ae.a,null,t.connection&&t.connection.name),r.createElement(ae.a,{align:"center"},r.createElement(kt,{question:t})))})))))))},fn=n(1221),bn=n(555),gn=n.n(bn),vn=n(556),yn=n.n(vn),On=r.memo((function(e){var t=e.title,n=e.subtitle,a=e.modified,c=e.waiting,l=e.runQuery,o=e.saveQuery;return r.createElement(H.a,{ml:1,mr:1},r.createElement(ze.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center"},r.createElement(ze.a,{item:!0},r.createElement(Y.a,{variant:"h5"},t),r.createElement(Y.a,{variant:"caption"},n)),r.createElement(ze.a,{item:!0},r.createElement(fn.a,{color:"primary"},r.createElement(ce.a,{variant:"outlined",color:"primary",size:"small",startIcon:r.createElement(gn.a,null),onClick:l},"Run"),r.createElement(ce.a,{variant:"outlined",color:"primary",size:"small",startIcon:r.createElement(yn.a,null),disabled:!a,onClick:o},"Save")))),c&&r.createElement(be.a,null))})),jn=n(557),xn=n.n(jn),wn=r.memo((function(e){var t=e.query,n=e.driver,a=e.onChange,c=r.useMemo((function(){return function(e){return"mongodb"===e?"javascript":"sql"}(n)}),[n]);return r.createElement(H.a,{p:1,height:"100%"},r.createElement(G.a,{style:{height:"100%"}},r.createElement($t.a,null,(function(e){var n=e.width,l=e.height;return r.createElement(xn.a,{width:n,height:l,language:c,theme:"vs-light",value:t||"",options:{selectOnLineNumbers:!0},onChange:a,editorDidMount:function(){}})}))))})),Cn=n(1222),kn=n(1228),Sn={"chart.line":"Line chart","chart.bar":"Bar chart","chart.pie":"Pie chart","chart.bubble":"Bubblee chart",documents:"Documents",columns:"Table"},_n={"chart.line":"X-Axis","chart.bar":"X-Axis","chart.bubble":"X-Axis","chart.pie":"Categories"},qn={"chart.line":"Y-Axis (multiple)","chart.bar":"Y-Axis (multiple)","chart.bubble":"Y-Axis","chart.pie":"Values"},An=function(e){var t=e.values,n=e.columns,a=e.type,c=e.onChange,l=t.xAxis||"",o=t.yAxis||("chart.bubble"===a?"":[]),i=t.zAxis||[],u="chart.bubble"===a?i:o;return r.createElement(r.Fragment,null,r.createElement(de.a,{fullWidth:!0},r.createElement(Ee.a,{id:"x-axis-select-label"},_n[a]),r.createElement(pe.a,{labelId:"x-axis-select-label",id:"x-axis-select",value:l,onChange:function(e){var t=e.target.value;return c("xAxis",t)},input:r.createElement(lt.a,{id:"x-axis-select-input"})},n&&n.map((function(e){return r.createElement(he.a,{key:e,value:e},e)})))),r.createElement(de.a,{fullWidth:!0},r.createElement(Ee.a,{id:"y-axis-select-label"},qn[a]),r.createElement(pe.a,{labelId:"y-axis-select-label",id:"y-axis-select",multiple:"chart.bubble"!==a,value:o,onChange:function(e){var t=e.target.value;return c("yAxis",t)},input:r.createElement(lt.a,{id:"y-axis-select-input"}),renderValue:function(e){return Array.isArray(e)?function(e){return e.map((function(e){return r.createElement(ot.a,{key:e,label:e,icon:r.createElement(mn,{color:t.colors[e],size:"small"})})}))}(e):[e]}},n&&n.map((function(e){return r.createElement(he.a,{key:e,value:e},e)})))),"chart.bubble"===a&&r.createElement(de.a,{fullWidth:!0},r.createElement(Ee.a,{id:"z-axis-select-label"},"Z-Axis"),r.createElement(pe.a,{labelId:"z-axis-select-label",id:"z-axis-select",multiple:!0,value:i,onChange:function(e){var t=e.target.value;return c("zAxis",t)},input:r.createElement(lt.a,{id:"z-axis-select-input"}),renderValue:function(e){return e.map((function(e){return r.createElement(ot.a,{key:e,label:e,icon:r.createElement(mn,{color:t.colors[e],size:"small"})})}))}},n&&n.map((function(e){return r.createElement(he.a,{key:e,value:e},e)})))),"chart.line"===a&&r.createElement(de.a,{fullWidth:!0},r.createElement(Cn.a,{control:r.createElement(kn.a,{checked:t.asArea||!1,color:"primary",onChange:function(e){return c("asArea",e.target.checked)}}),label:"Show area under the curve"})),r.createElement(H.a,{mt:3},r.createElement(Y.a,{variant:"caption"},"Colors:"),r.createElement(ze.a,{container:!0,spacing:3},u&&u.map((function(e){return r.createElement(dn,{key:e,column:e,color:t.colors[e],onChange:function(n){return c("colors",Object(E.a)({},t.colors,Object(S.a)({},e,n)))}})})))))},In=r.memo((function(e){var t=e.open,n=e.onClose,a=e.settings,c=e.type,l=e.onSubmit,o=r.useState(),i=Object(A.a)(o,2),u=i[0],s=i[1];r.useEffect((function(){s(a)}),[a]);if(!u)return null;var m=function(e,t){if("documents"===t||"columns"===t)return!0;if("chart.line"===t||"chart.bar"===t||"chart.pie"===t){var n=e[t];if(!n)return!1;if(!n.xAxis)return!1;if(!n.yAxis)return!1}return!0}(u,c),d=u[c]||{};return r.createElement(ie.a,{open:t,onClose:n},r.createElement(ue.a,null,"Configure ",Sn[c]," view for the question"),r.createElement(se.a,null,("documents"===c||"columns"===c)&&r.createElement(me.a,null,"Results will be shown as a list of rows"),c.startsWith("chart.")&&r.createElement(An,{values:d,columns:u.columns,onChange:function(e,t){var n=Object(E.a)({},u[c],{colors:Object(E.a)({},u[c]?u[c].colors:void 0)});if(n[e]=t,"yAxis"===e){var a,r=n.colors,l=Object(I.a)(t);try{for(l.s();!(a=l.n()).done;){var o=a.value;r[o]||(r[o]="#22194d")}}catch(p){l.e(p)}finally{l.f()}for(var i=0,m=Object.keys(r);i<m.length;i++){var d=m[i];-1===t.indexOf(d)&&delete r[d]}}s(Object(E.a)({},u,Object(S.a)({},c,n)))},type:c})),r.createElement(ge.a,null,r.createElement(ce.a,{onClick:function(e){n&&n()},color:"secondary"},"Cancel"),r.createElement(ce.a,{color:"primary",disabled:!m,onClick:function(){return l(u)}},"Apply")))})),Tn=function(){var e=Object(u.g)(),t=Object(u.h)(),n=Object(u.i)().params.question_id,a=z(n),c=a.loading,l=a.error,o=a.question,i=a.execution,s=a.waiting,m=a.save,h=a.run,f=a.updateSettings,b=r.useState(!1),g=Object(A.a)(b,2),v=g[0],y=g[1],O=r.useState(""),j=Object(A.a)(O,2),x=j[0],w=j[1],C=r.useState(),k=Object(A.a)(C,2),S=k[0],_=k[1],q=r.useState(),I=Object(A.a)(q,2),T=I[0],R=I[1],P=r.useState(!1),N=Object(A.a)(P,2),D=N[0],U=N[1];r.useEffect((function(){o&&!x&&w(o.query),o&&!S&&(_(o.visualSettings),R(o.visualSettings.type)),o&&o.query===x&&y(!1)}),[o,x,S]),!o||t.state&&t.state.title||e.replace(t.pathname,{title:o.name});var L=function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=Object(E.a)({},t)).type=T,_(n),f(n),U(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.createElement(r.Fragment,null,c&&r.createElement("h1",null,"Loading"),l&&r.createElement("h1",null,"Error"),o&&r.createElement(H.a,{m:1},r.createElement(On,{title:o.name,subtitle:o.connection.name,modified:v,waiting:s,runQuery:function(){return h(x)},saveQuery:function(){return m(x)}}),r.createElement(H.a,{mt:1,height:"calc((100vh - 160px) * 1/3)"},r.createElement(wn,{query:x,driver:o.connection.driver,onChange:function(e){w(e),v||y(!0)}})),i&&r.createElement(H.a,{mt:1,height:"calc((100vh - 160px) * 2/3)"},r.createElement(ln,{execution:i,driver:o.connection.driver,settings:S,requestVisualTypeChange:function(e,t){R(e),_(t),U(!0)},openVisualSettingsForm:function(){R(S?S.type:void 0),U(!0)},editable:!0,onResultUpdate:function(e){return _(Object(E.a)({},S,{columns:e.columns}))}})),r.createElement(In,{open:D,onClose:function(){return U(!1)},onSubmit:L,settings:S,type:T||""})))},Rn=function(){var e=Object(u.g)(),t=function(){var e=Object(s.useQuery)(C),t=e.payload,n=Object(_.a)(e,["payload"]);return Object(E.a)({},n,{dashboards:n.loading||n.error?void 0:t||[]})}(),n=t.loading,a=t.error,c=t.dashboards;return r.createElement(K.a,null,n&&r.createElement("h1",null,"Loading"),a&&r.createElement("h1",null,"Error"),c&&r.createElement(H.a,{m:1},r.createElement($.a,{component:G.a},r.createElement(ee.a,null,r.createElement(te.a,null,r.createElement(ne.a,null,r.createElement(ae.a,null,"Name"))),r.createElement(re.a,null,c.map((function(t){return r.createElement(ne.a,{key:t._id,hover:!0,classes:{hover:"clickable"},onClick:function(){return e.push("/dashboards/".concat(t._id))}},r.createElement(ae.a,null,t.name))})))))))},Pn=function(e){var t=e.questionId,n=z(t),a=(n.loading,n.error,n.question),c=n.execution;n.waiting,n.errorWaiting,n.run;return a?r.createElement(H.a,{height:300},r.createElement(B.a,{href:"/questions/".concat(a._id)},r.createElement(H.a,{ml:1},r.createElement(Y.a,{variant:"h6"},a.name))),r.createElement(ln,{execution:c,settings:a.visualSettings,driver:a.connection.driver})):null},Nn=function(){var e=Object(u.g)(),t=Object(u.h)(),n=Object(u.i)(),a=Object(He.a)(),c=function(e){var t=Object(s.useQuery)(function(e){return{method:"GET",endpoint:"/dashboards/".concat(e)}}(e));return{loading:t.loading,error:t.error,dashboard:t.payload}}(n.params.dashboard_id),l=c.loading,o=c.error,i=c.dashboard;return!i||t.state&&t.state.title||e.replace(t.pathname,{title:i.name}),r.createElement(r.Fragment,null,l&&r.createElement("h1",null,"Loading"),o&&r.createElement("h1",null,"Error"),i&&r.createElement(H.a,{width:"100%",m:1},r.createElement(ze.a,{container:!0,direction:"row",justify:"space-evenly","align-items":"center",wrap:"wrap"},i.questions.map((function(e){return r.createElement(H.a,{width:"min(".concat(a.breakpoints.values.sm,"px, 100%)"),mb:6},r.createElement(ze.a,{key:e,item:!0},r.createElement(Pn,{questionId:e})))})))))},Dn=function(){var e=W().user,t=Object(u.g)();return e?(t.push("/home"),null):r.createElement("h1",null,"Landing")},zn=Object(s.createClient)({requestInterceptors:[function(){return function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(E.a)({},t,{endpoint:"".concat(h[t.service||"API"]).concat(t.endpoint),headers:{"x-auth":localStorage.getItem("token")||""}}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]}),Un=function(){return r.createElement(s.ClientContextProvider,{client:zn},r.createElement(i.a,null,r.createElement(pn,null,r.createElement(vt,null),r.createElement(u.d,null,r.createElement(En,{path:"/home",component:J}),r.createElement(En,{path:"/dashboards/:dashboard_id",component:Nn}),r.createElement(En,{path:"/dashboards",component:Rn}),r.createElement(En,{path:"/questions/:question_id",component:Tn}),r.createElement(En,{path:"/questions",component:hn}),r.createElement(En,{path:"/admin/connections",component:qe}),r.createElement(En,{path:"/admin",component:Z}),r.createElement(u.b,{path:"/",component:Dn})))))};n(1058),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ln=n(1225),Qn=n(558),Fn=n.n(Qn);Ln.a.locale(Fn.a),o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(Un,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},597:function(e,t,n){e.exports=n(1070)}},[[597,2,3]]]);
//# sourceMappingURL=main.1b082bff.chunk.js.map